
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Welcome to discopy’s documentation! &#8212; discopy 1.1.4 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-discopy-s-documentation">
<h1>Welcome to discopy’s documentation!<a class="headerlink" href="#welcome-to-discopy-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
<span class="target" id="module-discopy"></span><p>discopy computes natural language meaning in pictures.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span><span class="p">,</span> <span class="n">Bob</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="n">Alice</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">loves</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Bob</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">Alice</span> <span class="o">@</span> <span class="n">loves</span> <span class="o">@</span> <span class="n">Bob</span> <span class="o">&gt;&gt;</span> <span class="n">grammar</span><span class="p">)</span>
</pre></div>
</div>
<span class="target" id="module-discopy.cat"></span><p>Implements free dagger categories and functors.
We can check the axioms of categories and functors.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">dom</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dom</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">cod</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">cod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="n">h</span> <span class="o">==</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="n">h</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Functor</span><span class="p">(</span><span class="n">ob</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">x</span><span class="p">},</span> <span class="n">ar</span><span class="o">=</span><span class="p">{</span><span class="n">f</span><span class="p">:</span> <span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">h</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span> <span class="o">==</span> <span class="n">F</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">F</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
<dl class="exception">
<dt id="discopy.cat.AxiomError">
<em class="property">exception </em><code class="sig-prename descclassname">discopy.cat.</code><code class="sig-name descname">AxiomError</code><a class="headerlink" href="#discopy.cat.AxiomError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="n">g</span><span class="p">])</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">cat.AxiomError</span>: <span class="n">Box with domain x expected, got Box(&#39;g&#39;, ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="n">f</span><span class="p">])</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">cat.AxiomError</span>: <span class="n">Box with codomain z expected, got Box(&#39;f&#39;, ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="n">f</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">cat.AxiomError</span>: <span class="n">Box(&#39;g&#39;,...) does not compose with Box(&#39;f&#39;, ...).</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="discopy.cat.AxiomError.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#discopy.cat.AxiomError.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="discopy.cat.AxiomError.with_traceback">
<code class="sig-name descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.AxiomError.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.cat.Box">
<em class="property">class </em><code class="sig-prename descclassname">discopy.cat.</code><code class="sig-name descname">Box</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">dom</em>, <em class="sig-param">cod</em>, <em class="sig-param">data=None</em>, <em class="sig-param">_dagger=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Box" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.cat.Diagram" title="discopy.cat.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.cat.Diagram</span></code></a></p>
<p>Defines a box as a diagram with a name, and itself as box.
Boxes can hold any Python object as data attribute, default is None.</p>
<p>Note that when we compose a box with an identity,
we get a diagram that is defined as equal to the original box.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">f</span>  
<span class="go">Diagram(Ob(&#39;x&#39;), Ob(&#39;y&#39;), [Box(&#39;f&#39;, ...)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">f</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.cat.Box.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.cat.Box.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Box.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.cat.Box.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Box.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Box.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">dom</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">cod</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Box.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.cat.Box.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Box.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.cat.Box.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Box.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Box.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Box.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.cat.Box.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Box.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Box.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span> <span class="o">==</span> <span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">x</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Expected Diagram, got Ob(&#39;x&#39;) ... instead.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.cat.Diagram">
<em class="property">class </em><code class="sig-prename descclassname">discopy.cat.</code><code class="sig-name descname">Diagram</code><span class="sig-paren">(</span><em class="sig-param">dom</em>, <em class="sig-param">cod</em>, <em class="sig-param">boxes</em>, <em class="sig-param">_fast=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines a diagram with domain, codomain and a list of boxes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="n">h</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.cat.Diagram.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.cat.Diagram.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Diagram.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.cat.Diagram.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Diagram.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Diagram.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Diagram.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.cat.Diagram.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Diagram.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Diagram.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Diagram.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Diagram.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span> <span class="o">==</span> <span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">x</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Expected Diagram, got Ob(&#39;x&#39;) ... instead.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.cat.Functor">
<em class="property">class </em><code class="sig-prename descclassname">discopy.cat.</code><code class="sig-name descname">Functor</code><span class="sig-paren">(</span><em class="sig-param">ob</em>, <em class="sig-param">ar</em>, <em class="sig-param">ob_cls=&lt;class 'discopy.cat.Ob'&gt;</em>, <em class="sig-param">ar_cls=&lt;class 'discopy.cat.Diagram'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Functor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines a functor given its image on objects and boxes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Functor</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="p">},</span> <span class="p">{</span><span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">(),</span> <span class="n">g</span><span class="p">:</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">((</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span> <span class="o">==</span> <span class="n">F</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.cat.Functor.ar">
<em class="property">property </em><code class="sig-name descname">ar</code><a class="headerlink" href="#discopy.cat.Functor.ar" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ar</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Functor.ob">
<em class="property">property </em><code class="sig-name descname">ob</code><a class="headerlink" href="#discopy.cat.Functor.ob" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ob</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.cat.Id">
<em class="property">class </em><code class="sig-prename descclassname">discopy.cat.</code><code class="sig-name descname">Id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Id" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.cat.Diagram" title="discopy.cat.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.cat.Diagram</span></code></a></p>
<p>Define an identity diagram, i.e. with an empty list of boxes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.cat.Id.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.cat.Id.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Id.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.cat.Id.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Id.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Id.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Id.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.cat.Id.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Id.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Id.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.cat.Id.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Id.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span> <span class="o">==</span> <span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">x</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Expected Diagram, got Ob(&#39;x&#39;) ... instead.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.cat.Ob">
<em class="property">class </em><code class="sig-prename descclassname">discopy.cat.</code><code class="sig-name descname">Ob</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Ob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines an object, only distinguished by its name.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.cat.Ob.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.cat.Ob.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the object, can be of any type.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;x&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.cat.Quiver">
<em class="property">class </em><code class="sig-prename descclassname">discopy.cat.</code><code class="sig-name descname">Quiver</code><span class="sig-paren">(</span><em class="sig-param">func</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.cat.Quiver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wraps a Python function into a dict.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Functor</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="p">},</span> <span class="n">Quiver</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Box(&#39;f&#39;, Ob(&#39;x&#39;), Ob(&#39;y&#39;), data=[0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Box(&#39;f&#39;, Ob(&#39;x&#39;), Ob(&#39;y&#39;), data=[0, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-discopy.moncat"></span><p>Implements free monoidal categories and (dagger) monoidal functors.</p>
<p>We can check the axioms for dagger monoidal categories, up to interchanger.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">==</span> <span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
<p>We can check the Eckerman-Hilton argument, up to interchanger.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">s0</span> <span class="o">@</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s0</span> <span class="o">&gt;&gt;</span> <span class="n">s1</span> <span class="o">==</span> <span class="p">(</span><span class="n">s1</span> <span class="o">@</span> <span class="n">s0</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">s1</span> <span class="o">@</span> <span class="n">s0</span> <span class="o">==</span> <span class="n">s1</span> <span class="o">&gt;&gt;</span> <span class="n">s0</span> <span class="o">==</span> <span class="p">(</span><span class="n">s0</span> <span class="o">@</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="exception">
<dt id="discopy.moncat.AxiomError">
<em class="property">exception </em><code class="sig-prename descclassname">discopy.moncat.</code><code class="sig-name descname">AxiomError</code><a class="headerlink" href="#discopy.moncat.AxiomError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.cat.AxiomError" title="discopy.cat.AxiomError"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.cat.AxiomError</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">moncat.AxiomError</span>: <span class="n">Codomain x expected, got y instead.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">moncat.AxiomError</span>: <span class="n">Domain y expected, got x instead.</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="discopy.moncat.AxiomError.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#discopy.moncat.AxiomError.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="discopy.moncat.AxiomError.with_traceback">
<code class="sig-name descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.AxiomError.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.moncat.Box">
<em class="property">class </em><code class="sig-prename descclassname">discopy.moncat.</code><code class="sig-name descname">Box</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">dom</em>, <em class="sig-param">cod</em>, <em class="sig-param">data=None</em>, <em class="sig-param">_dagger=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.cat.Box" title="discopy.cat.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.cat.Box</span></code></a>, <a class="reference internal" href="#discopy.moncat.Diagram" title="discopy.moncat.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.moncat.Diagram</span></code></a></p>
<p>Implements a box as a diagram with a name and itself as box.</p>
<p>Note that as for composition, when we tensor an empty diagram with a box,
we get a diagram that is defined as equal to the original box.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">f</span>  
<span class="go">Diagram(dom=Ty(&#39;x&#39;, &#39;y&#39;), cod=Ty(&#39;z&#39;), boxes=[Box(...)], offsets=[0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">f</span>  
<span class="go">Diagram(dom=Ty(&#39;x&#39;, &#39;y&#39;), cod=Ty(&#39;z&#39;), boxes=[Box(...)], offsets=[0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.moncat.Box.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.moncat.Box.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.moncat.Box.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">dom</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">cod</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.moncat.Box.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.moncat.Box.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_0 (f0)</span>
<span class="go">box_1 (f1)</span>
<span class="go">input_0 (x)</span>
<span class="go">input_1 (z)</span>
<span class="go">output_0 (y)</span>
<span class="go">output_1 (w)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_0 (-1.0, 2)</span>
<span class="go">box_1 (0.0, 1)</span>
<span class="go">input_0 (-1.0, 3)</span>
<span class="go">input_1 (0.0, 3)</span>
<span class="go">output_0 (-1.0, 0)</span>
<span class="go">output_1 (0.0, 0)</span>
<span class="go">wire_0_1 (0.0, 2)</span>
<span class="go">wire_1_0 (-1.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_0 -&gt; wire_1_0</span>
<span class="go">box_1 -&gt; output_1</span>
<span class="go">input_0 -&gt; box_0</span>
<span class="go">input_1 -&gt; wire_0_1</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_1_0 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.interchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new diagram with boxes i and j interchanged.
If there is a choice, i.e. when interchanging an effect and a state,
then we return the right interchange move by default.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">f @ Id(y) &gt;&gt; Id(y) @ f.dagger()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Id(x) @ f.dagger() &gt;&gt; f @ Id(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">d</span> <span class="o">&gt;&gt;</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">Id(x) @ f.dagger() &gt;&gt; Id(x) @ f &gt;&gt; f @ Id(y) &gt;&gt; f.dagger() @ Id(y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;cap&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">cup</span> <span class="o">&gt;&gt;</span> <span class="n">cap</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">cap @ Id(x @ x) &gt;&gt; Id(x @ x) @ cup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">cup</span> <span class="o">&gt;&gt;</span> <span class="n">cap</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x) @ cap &gt;&gt; cup @ Id(x @ x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">moncat.InterchangerError</span>: <span class="n">Boxes ... do not commute.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">f0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.moncat.Box.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements normalisation of connected diagrams, see arXiv:1804.07832.
By default, we apply only right exchange moves.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">s0</span> <span class="o">&gt;&gt;</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Diagram s0 &gt;&gt; s1 is not connected.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f0</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f0</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generator which yields the diagrams at each step towards
a normal form. Never halts if the diagram is not connected.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="p">(</span><span class="n">s0</span> <span class="o">@</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>
<span class="go">s1 &gt;&gt; s0</span>
<span class="go">s0 &gt;&gt; s1</span>
<span class="go">s1 &gt;&gt; s0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">f0 @ Id(y) &gt;&gt; Id(y) @ f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">Id(x) @ f1 &gt;&gt; f0 @ Id(x)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.moncat.Box.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f0</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span> <span class="o">==</span> <span class="n">f0</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Box.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Box.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">Id(x) @ f1 &gt;&gt; f0 @ Id(w)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.moncat.Diagram">
<em class="property">class </em><code class="sig-prename descclassname">discopy.moncat.</code><code class="sig-name descname">Diagram</code><span class="sig-paren">(</span><em class="sig-param">dom</em>, <em class="sig-param">cod</em>, <em class="sig-param">boxes</em>, <em class="sig-param">offsets</em>, <em class="sig-param">_fast=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.cat.Diagram" title="discopy.cat.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.cat.Diagram</span></code></a></p>
<p>Implements a diagram with dom, cod, a list of boxes and offsets.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span> <span class="o">@</span> <span class="n">w</span><span class="p">,</span> <span class="p">[</span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.moncat.Diagram.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.moncat.Diagram.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.moncat.Diagram.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span>
<span class="go">Id(y) @ f1.dagger() &gt;&gt; f0.dagger() @ Id(z)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.moncat.Diagram.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_0 (f0)</span>
<span class="go">box_1 (f1)</span>
<span class="go">input_0 (x)</span>
<span class="go">input_1 (z)</span>
<span class="go">output_0 (y)</span>
<span class="go">output_1 (w)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_0 (-1.0, 2)</span>
<span class="go">box_1 (0.0, 1)</span>
<span class="go">input_0 (-1.0, 3)</span>
<span class="go">input_1 (0.0, 3)</span>
<span class="go">output_0 (-1.0, 0)</span>
<span class="go">output_1 (0.0, 0)</span>
<span class="go">wire_0_1 (0.0, 2)</span>
<span class="go">wire_1_0 (-1.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_0 -&gt; wire_1_0</span>
<span class="go">box_1 -&gt; output_1</span>
<span class="go">input_0 -&gt; box_0</span>
<span class="go">input_1 -&gt; wire_0_1</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_1_0 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.interchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new diagram with boxes i and j interchanged.
If there is a choice, i.e. when interchanging an effect and a state,
then we return the right interchange move by default.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">f @ Id(y) &gt;&gt; Id(y) @ f.dagger()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Id(x) @ f.dagger() &gt;&gt; f @ Id(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">d</span> <span class="o">&gt;&gt;</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">Id(x) @ f.dagger() &gt;&gt; Id(x) @ f &gt;&gt; f @ Id(y) &gt;&gt; f.dagger() @ Id(y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;cap&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">cup</span> <span class="o">&gt;&gt;</span> <span class="n">cap</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">cap @ Id(x @ x) &gt;&gt; Id(x @ x) @ cup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">cup</span> <span class="o">&gt;&gt;</span> <span class="n">cap</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x) @ cap &gt;&gt; cup @ Id(x @ x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">moncat.InterchangerError</span>: <span class="n">Boxes ... do not commute.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">f0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements normalisation of connected diagrams, see arXiv:1804.07832.
By default, we apply only right exchange moves.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">s0</span> <span class="o">&gt;&gt;</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Diagram s0 &gt;&gt; s1 is not connected.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f0</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f0</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generator which yields the diagrams at each step towards
a normal form. Never halts if the diagram is not connected.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="p">(</span><span class="n">s0</span> <span class="o">@</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>
<span class="go">s1 &gt;&gt; s0</span>
<span class="go">s0 &gt;&gt; s1</span>
<span class="go">s1 &gt;&gt; s0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">f0 @ Id(y) &gt;&gt; Id(y) @ f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">Id(x) @ f1 &gt;&gt; f0 @ Id(x)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.moncat.Diagram.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f0</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span> <span class="o">==</span> <span class="n">f0</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Diagram.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Diagram.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">Id(x) @ f1 &gt;&gt; f0 @ Id(w)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.moncat.Id">
<em class="property">class </em><code class="sig-prename descclassname">discopy.moncat.</code><code class="sig-name descname">Id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.moncat.Diagram" title="discopy.moncat.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.moncat.Diagram</span></code></a></p>
<p>Implements the identity diagram of a given type.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.moncat.Id.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.moncat.Id.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.moncat.Id.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span>
<span class="go">Id(y) @ f1.dagger() &gt;&gt; f0.dagger() @ Id(z)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.moncat.Id.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_0 (f0)</span>
<span class="go">box_1 (f1)</span>
<span class="go">input_0 (x)</span>
<span class="go">input_1 (z)</span>
<span class="go">output_0 (y)</span>
<span class="go">output_1 (w)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_0 (-1.0, 2)</span>
<span class="go">box_1 (0.0, 1)</span>
<span class="go">input_0 (-1.0, 3)</span>
<span class="go">input_1 (0.0, 3)</span>
<span class="go">output_0 (-1.0, 0)</span>
<span class="go">output_1 (0.0, 0)</span>
<span class="go">wire_0_1 (0.0, 2)</span>
<span class="go">wire_1_0 (-1.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_0 -&gt; wire_1_0</span>
<span class="go">box_1 -&gt; output_1</span>
<span class="go">input_0 -&gt; box_0</span>
<span class="go">input_1 -&gt; wire_0_1</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_1_0 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.interchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new diagram with boxes i and j interchanged.
If there is a choice, i.e. when interchanging an effect and a state,
then we return the right interchange move by default.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">f @ Id(y) &gt;&gt; Id(y) @ f.dagger()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Id(x) @ f.dagger() &gt;&gt; f @ Id(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">d</span> <span class="o">&gt;&gt;</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">Id(x) @ f.dagger() &gt;&gt; Id(x) @ f &gt;&gt; f @ Id(y) &gt;&gt; f.dagger() @ Id(y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;cap&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">cup</span> <span class="o">&gt;&gt;</span> <span class="n">cap</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">cap @ Id(x @ x) &gt;&gt; Id(x @ x) @ cup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">cup</span> <span class="o">&gt;&gt;</span> <span class="n">cap</span><span class="p">)</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x) @ cap &gt;&gt; cup @ Id(x @ x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">moncat.InterchangerError</span>: <span class="n">Boxes ... do not commute.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">f0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements normalisation of connected diagrams, see arXiv:1804.07832.
By default, we apply only right exchange moves.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">s0</span> <span class="o">&gt;&gt;</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Diagram s0 &gt;&gt; s1 is not connected.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f0</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f0</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generator which yields the diagrams at each step towards
a normal form. Never halts if the diagram is not connected.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">()),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="p">(</span><span class="n">s0</span> <span class="o">@</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>
<span class="go">s1 &gt;&gt; s0</span>
<span class="go">s0 &gt;&gt; s1</span>
<span class="go">s1 &gt;&gt; s0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">f0 @ Id(y) &gt;&gt; Id(y) @ f1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">Id(x) @ f1 &gt;&gt; f0 @ Id(x)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.moncat.Id.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f0</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span> <span class="o">==</span> <span class="n">f0</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Id.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Id.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">Id(x) @ f1 &gt;&gt; f0 @ Id(w)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="discopy.moncat.InterchangerError">
<em class="property">exception </em><code class="sig-prename descclassname">discopy.moncat.</code><code class="sig-name descname">InterchangerError</code><a class="headerlink" href="#discopy.moncat.InterchangerError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.moncat.AxiomError" title="discopy.moncat.AxiomError"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.moncat.AxiomError</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">moncat.InterchangerError</span>: <span class="n">Boxes ... do not commute.</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="discopy.moncat.InterchangerError.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#discopy.moncat.InterchangerError.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="discopy.moncat.InterchangerError.with_traceback">
<code class="sig-name descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.InterchangerError.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.moncat.MonoidalFunctor">
<em class="property">class </em><code class="sig-prename descclassname">discopy.moncat.</code><code class="sig-name descname">MonoidalFunctor</code><span class="sig-paren">(</span><em class="sig-param">ob</em>, <em class="sig-param">ar</em>, <em class="sig-param">ob_cls=&lt;class 'discopy.moncat.Ty'&gt;</em>, <em class="sig-param">ar_cls=&lt;class 'discopy.moncat.Diagram'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.MonoidalFunctor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.cat.Functor" title="discopy.cat.Functor"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.cat.Functor</span></code></a></p>
<p>Implements a monoidal functor given its image on objects and arrows.
One may define monoidal functors into custom categories by overriding
the defaults ob_cls=Ty and ar_cls=Diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">]),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">MonoidalFunctor</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">w</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="n">y</span><span class="p">},</span> <span class="p">{</span><span class="n">f0</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f1</span><span class="p">:</span> <span class="n">f0</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">f0</span><span class="p">)</span> <span class="o">==</span> <span class="n">f1</span> <span class="ow">and</span> <span class="n">F</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span> <span class="o">==</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">f0</span><span class="p">))</span> <span class="o">==</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">f0</span> <span class="o">@</span> <span class="n">f1</span><span class="p">)</span> <span class="o">==</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">f0</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span> <span class="o">==</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.moncat.MonoidalFunctor.ar">
<em class="property">property </em><code class="sig-name descname">ar</code><a class="headerlink" href="#discopy.moncat.MonoidalFunctor.ar" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ar</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.MonoidalFunctor.ob">
<em class="property">property </em><code class="sig-name descname">ob</code><a class="headerlink" href="#discopy.moncat.MonoidalFunctor.ob" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ob</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.moncat.Ty">
<em class="property">class </em><code class="sig-prename descclassname">discopy.moncat.</code><code class="sig-name descname">Ty</code><span class="sig-paren">(</span><em class="sig-param">*t</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.moncat.Ty" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.cat.Ob" title="discopy.cat.Ob"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.cat.Ob</span></code></a></p>
<p>Implements a type as a list of objects, used as dom and cod of diagrams.
Types are the free monoid on objects with product &#64; and unit Ty().</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span> <span class="o">!=</span> <span class="n">y</span> <span class="o">@</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">x</span> <span class="o">@</span> <span class="n">Ty</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span> <span class="o">==</span> <span class="n">Ty</span><span class="p">()</span> <span class="o">@</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">z</span> <span class="o">==</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span> <span class="o">@</span> <span class="n">z</span> <span class="o">==</span> <span class="n">x</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span> <span class="o">@</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.moncat.Ty.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.moncat.Ty.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the object, can be of any type.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;x&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.moncat.Ty.objects">
<em class="property">property </em><code class="sig-name descname">objects</code><a class="headerlink" href="#discopy.moncat.Ty.objects" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">objects</span>
<span class="go">[Ob(&#39;x&#39;), Ob(&#39;y&#39;), Ob(&#39;z&#39;)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-discopy.pregroup"></span><p>Implements free dagger pivotal and rigid monoidal categories.
The objects are given by the free pregroup, the arrows by planar diagrams.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">t</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">t</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">@</span> <span class="n">t</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">t</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">r</span> <span class="o">==</span> <span class="n">t</span> <span class="o">==</span> <span class="n">t</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snake_l</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snake_r</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">snake_l</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">snake_l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">snake_l</span> <span class="o">&gt;&gt;</span> <span class="n">snake_r</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>\
<span class="gp">... </span>        <span class="o">==</span> <span class="n">snake_l</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">snake_r</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
<dl class="exception">
<dt id="discopy.pregroup.AxiomError">
<em class="property">exception </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">AxiomError</code><a class="headerlink" href="#discopy.pregroup.AxiomError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.moncat.AxiomError" title="discopy.moncat.AxiomError"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.moncat.AxiomError</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Cup</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">))</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">n and n are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cup</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">n and s are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cup</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">n and n.l.l are not adjoints.</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="discopy.pregroup.AxiomError.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#discopy.pregroup.AxiomError.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="discopy.pregroup.AxiomError.with_traceback">
<code class="sig-name descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.AxiomError.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.pregroup.Box">
<em class="property">class </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">Box</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">dom</em>, <em class="sig-param">cod</em>, <em class="sig-param">data=None</em>, <em class="sig-param">_dagger=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.moncat.Box" title="discopy.moncat.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.moncat.Box</span></code></a>, <a class="reference internal" href="#discopy.pregroup.Diagram" title="discopy.pregroup.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Diagram</span></code></a></p>
<p>Implements generators of dagger pivotal diagrams.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="mi">42</span><span class="p">})</span>
<span class="go">Box(&#39;f&#39;, Ty(&#39;a&#39;), Ty(Ob(&#39;b&#39;, z=-1), &#39;b&#39;), data={42})</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.pregroup.Box.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.pregroup.Box.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.caps" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.l @ b.l are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cap</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.pregroup.Box.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.cups" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.r @ b.r are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&lt;&lt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">dom</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">cod</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.pregroup.Box.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.pregroup.Box.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)))</span>
<span class="go">Id(s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.pregroup.Box.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the normalisation of rigid monoidal categories,
see arxiv:1601.05372, definition 2.12.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">counit</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;counit&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twist</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">twist</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">twist</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">twist</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">twist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">counit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">unit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_rl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_rl</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_lr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_lr</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eckmann_Hilton</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Eckmann_Hilton</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">Diagram s0 &gt;&gt; s1 is not connected.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.pregroup.Box.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f.dagger() @ Id(a) &gt;&gt; Id(a) @ f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f &gt;&gt; f.dagger() &gt;&gt; f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Box.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Box.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.pregroup.Cap">
<em class="property">class </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">Cap</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Box" title="discopy.pregroup.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Box</span></code></a></p>
<p>Defines cups for simple types.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">cod</span><span class="p">)</span>
<span class="go">n @ n.l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">cod</span><span class="p">)</span>
<span class="go">n @ n.r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">cod</span><span class="p">)</span>
<span class="go">n.l.l @ n.l</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.pregroup.Cap.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.pregroup.Cap.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.caps" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.l @ b.l are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cap</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.pregroup.Cap.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.cups" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.r @ b.r are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&lt;&lt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Cup(Ty(&#39;n&#39;), Ty(Ob(&#39;n&#39;, z=-1)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.pregroup.Cap.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.pregroup.Cap.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)))</span>
<span class="go">Id(s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.pregroup.Cap.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the normalisation of rigid monoidal categories,
see arxiv:1601.05372, definition 2.12.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">counit</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;counit&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twist</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">twist</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">twist</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">twist</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">twist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">counit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">unit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_rl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_rl</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_lr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_lr</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eckmann_Hilton</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Eckmann_Hilton</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">Diagram s0 &gt;&gt; s1 is not connected.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.pregroup.Cap.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f.dagger() @ Id(a) &gt;&gt; Id(a) @ f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f &gt;&gt; f.dagger() &gt;&gt; f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cap.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cap.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.pregroup.Cup">
<em class="property">class </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">Cup</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Box" title="discopy.pregroup.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Box</span></code></a>, <a class="reference internal" href="#discopy.pregroup.Diagram" title="discopy.pregroup.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Diagram</span></code></a></p>
<p>Defines cups for simple types.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="go">Cup(Ty(&#39;n&#39;), Ty(Ob(&#39;n&#39;, z=-1)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="go">Cup(Ty(&#39;n&#39;), Ty(Ob(&#39;n&#39;, z=1)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="go">Cup(Ty(Ob(&#39;n&#39;, z=-2)), Ty(Ob(&#39;n&#39;, z=-1)))</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.pregroup.Cup.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.pregroup.Cup.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.caps" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.l @ b.l are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cap</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.pregroup.Cup.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.cups" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.r @ b.r are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&lt;&lt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Cap(Ty(&#39;n&#39;), Ty(Ob(&#39;n&#39;, z=-1)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.pregroup.Cup.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.pregroup.Cup.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)))</span>
<span class="go">Id(s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.pregroup.Cup.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the normalisation of rigid monoidal categories,
see arxiv:1601.05372, definition 2.12.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">counit</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;counit&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twist</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">twist</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">twist</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">twist</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">twist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">counit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">unit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_rl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_rl</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_lr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_lr</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eckmann_Hilton</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Eckmann_Hilton</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">Diagram s0 &gt;&gt; s1 is not connected.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.pregroup.Cup.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f.dagger() @ Id(a) &gt;&gt; Id(a) @ f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f &gt;&gt; f.dagger() &gt;&gt; f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Cup.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Cup.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.pregroup.Diagram">
<em class="property">class </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">Diagram</code><span class="sig-paren">(</span><em class="sig-param">dom</em>, <em class="sig-param">cod</em>, <em class="sig-param">boxes</em>, <em class="sig-param">offsets</em>, <em class="sig-param">_fast=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.moncat.Diagram" title="discopy.moncat.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.moncat.Diagram</span></code></a></p>
<p>Implements diagrams in free dagger pivotal categories.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span><span class="p">,</span> <span class="n">jokes</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;jokes&#39;</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxes</span><span class="p">,</span> <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">Alice</span><span class="p">,</span> <span class="n">jokes</span><span class="p">,</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Diagram</span><span class="p">(</span><span class="n">Alice</span><span class="o">.</span><span class="n">dom</span> <span class="o">@</span> <span class="n">jokes</span><span class="o">.</span><span class="n">dom</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">offsets</span><span class="p">))</span>
<span class="go">Alice &gt;&gt; Id(n) @ jokes &gt;&gt; Cup(n, n.l) @ Id(s)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.pregroup.Diagram.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.pregroup.Diagram.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.caps" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.l @ b.l are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cap</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.pregroup.Diagram.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.cups" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.r @ b.r are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&lt;&lt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">==</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.pregroup.Diagram.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)))</span>
<span class="go">Id(s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the normalisation of rigid monoidal categories,
see arxiv:1601.05372, definition 2.12.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">counit</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;counit&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twist</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">twist</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">twist</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">twist</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">twist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">counit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">unit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_rl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_rl</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_lr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_lr</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eckmann_Hilton</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Eckmann_Hilton</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">Diagram s0 &gt;&gt; s1 is not connected.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.pregroup.Diagram.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f.dagger() @ Id(a) &gt;&gt; Id(a) @ f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f &gt;&gt; f.dagger() &gt;&gt; f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Diagram.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Diagram.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.pregroup.Id">
<em class="property">class </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">Id</code><span class="sig-paren">(</span><em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Diagram" title="discopy.pregroup.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Diagram</span></code></a></p>
<p>Define an identity arrow in a free rigid category</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">Diagram</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.pregroup.Id.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.pregroup.Id.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.caps" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.l @ b.l are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cap</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.pregroup.Id.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.cups" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.r @ b.r are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&lt;&lt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">==</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.pregroup.Id.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)))</span>
<span class="go">Id(s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the normalisation of rigid monoidal categories,
see arxiv:1601.05372, definition 2.12.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">counit</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;counit&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twist</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">twist</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">twist</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">twist</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">twist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">counit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">unit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_rl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_rl</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_lr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_lr</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eckmann_Hilton</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Eckmann_Hilton</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">Diagram s0 &gt;&gt; s1 is not connected.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.pregroup.Id.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f.dagger() @ Id(a) &gt;&gt; Id(a) @ f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f &gt;&gt; f.dagger() &gt;&gt; f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Id.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Id.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.pregroup.Ob">
<em class="property">class </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">Ob</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">z=0</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Ob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.cat.Ob" title="discopy.cat.Ob"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.cat.Ob</span></code></a></p>
<p>Implements simple pregroup types: basic types and their iterated adjoints.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">r</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">l</span> <span class="o">==</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">l</span> <span class="o">!=</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.pregroup.Ob.l">
<em class="property">property </em><code class="sig-name descname">l</code><a class="headerlink" href="#discopy.pregroup.Ob.l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">l</span>
<span class="go">Ob(&#39;a&#39;, z=-1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Ob.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.pregroup.Ob.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the object, can be of any type.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;x&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Ob.r">
<em class="property">property </em><code class="sig-name descname">r</code><a class="headerlink" href="#discopy.pregroup.Ob.r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">r</span>
<span class="go">Ob(&#39;a&#39;, z=1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Ob.z">
<em class="property">property </em><code class="sig-name descname">z</code><a class="headerlink" href="#discopy.pregroup.Ob.z" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">z</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.pregroup.PivotalFunctor">
<em class="property">class </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">PivotalFunctor</code><span class="sig-paren">(</span><em class="sig-param">ob</em>, <em class="sig-param">ar</em>, <em class="sig-param">ob_cls=&lt;class 'discopy.pregroup.Ty'&gt;</em>, <em class="sig-param">ar_cls=&lt;class 'discopy.pregroup.Diagram'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.PivotalFunctor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.moncat.MonoidalFunctor" title="discopy.moncat.MonoidalFunctor"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.moncat.MonoidalFunctor</span></code></a></p>
<p>Implements functors between pivotal categories preserving cups and caps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">love_box</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">n</span> <span class="o">@</span> <span class="n">n</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="p">{</span><span class="n">loves</span><span class="p">:</span> <span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>             <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">love_box</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">PivotalFunctor</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">F</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">r</span> <span class="ow">and</span> <span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">==</span> <span class="n">Cap</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span> <span class="o">==</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">n</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span> <span class="o">@</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.pregroup.PivotalFunctor.ar">
<em class="property">property </em><code class="sig-name descname">ar</code><a class="headerlink" href="#discopy.pregroup.PivotalFunctor.ar" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ar</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.PivotalFunctor.ob">
<em class="property">property </em><code class="sig-name descname">ob</code><a class="headerlink" href="#discopy.pregroup.PivotalFunctor.ob" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ob</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.pregroup.Ty">
<em class="property">class </em><code class="sig-prename descclassname">discopy.pregroup.</code><code class="sig-name descname">Ty</code><span class="sig-paren">(</span><em class="sig-param">*t</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.pregroup.Ty" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.moncat.Ty" title="discopy.moncat.Ty"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.moncat.Ty</span></code></a></p>
<p>Implements pregroup types as lists of simple types.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">r</span> <span class="o">==</span> <span class="n">n</span> <span class="o">==</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">l</span> <span class="o">==</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">s</span><span class="o">.</span><span class="n">l</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">r</span> <span class="o">==</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">s</span><span class="o">.</span><span class="n">r</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.pregroup.Ty.is_basic">
<em class="property">property </em><code class="sig-name descname">is_basic</code><a class="headerlink" href="#discopy.pregroup.Ty.is_basic" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">s</span><span class="o">.</span><span class="n">is_basic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">is_basic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">is_basic</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Ty.l">
<em class="property">property </em><code class="sig-name descname">l</code><a class="headerlink" href="#discopy.pregroup.Ty.l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">l</span>
<span class="go">Ty(&#39;n&#39;, Ob(&#39;s&#39;, z=-1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Ty.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.pregroup.Ty.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the object, can be of any type.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;x&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Ty.objects">
<em class="property">property </em><code class="sig-name descname">objects</code><a class="headerlink" href="#discopy.pregroup.Ty.objects" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">objects</span>
<span class="go">[Ob(&#39;x&#39;), Ob(&#39;y&#39;), Ob(&#39;z&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.pregroup.Ty.r">
<em class="property">property </em><code class="sig-name descname">r</code><a class="headerlink" href="#discopy.pregroup.Ty.r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">r</span>
<span class="go">Ty(&#39;n&#39;, Ob(&#39;s&#39;, z=1))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-discopy.matrix"></span><p>Implements dagger monoidal functors into matrices.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span><span class="p">,</span> <span class="n">Bob</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">)},</span> <span class="p">{</span><span class="n">Alice</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">loves</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Bob</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">MatrixFunctor</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="p">(</span><span class="n">Alice</span> <span class="o">&gt;&gt;</span> <span class="n">loves</span> <span class="o">&gt;&gt;</span> <span class="n">Bob</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(1), array=[1])</span>
</pre></div>
</div>
<dl class="exception">
<dt id="discopy.matrix.AxiomError">
<em class="property">exception </em><code class="sig-prename descclassname">discopy.matrix.</code><code class="sig-name descname">AxiomError</code><a class="headerlink" href="#discopy.matrix.AxiomError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.AxiomError" title="discopy.pregroup.AxiomError"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.AxiomError</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">m</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">matrix.AxiomError</span>: <span class="n">Matrix... does not compose with Matrix...</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="discopy.matrix.AxiomError.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#discopy.matrix.AxiomError.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="discopy.matrix.AxiomError.with_traceback">
<code class="sig-name descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.AxiomError.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.matrix.Dim">
<em class="property">class </em><code class="sig-prename descclassname">discopy.matrix.</code><code class="sig-name descname">Dim</code><span class="sig-paren">(</span><em class="sig-param">*xs</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Ty" title="discopy.pregroup.Ty"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Ty</span></code></a></p>
<p>Implements dimensions as tuples of positive integers.
Dimensions form a monoid with product &#64; and unit Dim(1).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dim</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Dim(2, 3)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.matrix.Dim.is_basic">
<em class="property">property </em><code class="sig-name descname">is_basic</code><a class="headerlink" href="#discopy.matrix.Dim.is_basic" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">s</span><span class="o">.</span><span class="n">is_basic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">is_basic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">is_basic</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Dim.l">
<em class="property">property </em><code class="sig-name descname">l</code><a class="headerlink" href="#discopy.matrix.Dim.l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">l</span> <span class="o">==</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Dim.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.matrix.Dim.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the object, can be of any type.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;x&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Dim.objects">
<em class="property">property </em><code class="sig-name descname">objects</code><a class="headerlink" href="#discopy.matrix.Dim.objects" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">objects</span>
<span class="go">[Ob(&#39;x&#39;), Ob(&#39;y&#39;), Ob(&#39;z&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Dim.r">
<em class="property">property </em><code class="sig-name descname">r</code><a class="headerlink" href="#discopy.matrix.Dim.r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">r</span> <span class="o">==</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.matrix.Id">
<em class="property">class </em><code class="sig-prename descclassname">discopy.matrix.</code><code class="sig-name descname">Id</code><span class="sig-paren">(</span><em class="sig-param">*dim</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.matrix.Matrix" title="discopy.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.matrix.Matrix</span></code></a></p>
<p>Implements the identity matrix for a given dimension.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(1), array=[1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Matrix(dom=Dim(2), cod=Dim(2), array=[1.0, 0.0, 0.0, 1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  
<span class="go">Matrix(dom=Dim(2, 3), cod=Dim(2, 3), array=[1.0, ..., 1.0])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.matrix.Id.array">
<em class="property">property </em><code class="sig-name descname">array</code><a class="headerlink" href="#discopy.matrix.Id.array" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">[0, 1, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.matrix.Id.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Matrix</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.matrix.Id.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Matrix</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2), cod=Dim(2, 2), array=[1, 0, 0, 1, 0, 1, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.matrix.Id.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.matrix.Id.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.matrix.Id.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the normalisation of rigid monoidal categories,
see arxiv:1601.05372, definition 2.12.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">counit</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;counit&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twist</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">twist</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">twist</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">twist</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">twist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">counit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">unit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_rl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_rl</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_lr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_lr</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eckmann_Hilton</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Eckmann_Hilton</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">Diagram s0 &gt;&gt; s1 is not connected.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.matrix.Id.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">@</span> <span class="n">v</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">@</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2), cod=Dim(2), array=[1, 0, 0, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">v</span> <span class="o">@</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">==</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Id.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Id.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.matrix.Matrix">
<em class="property">class </em><code class="sig-prename descclassname">discopy.matrix.</code><code class="sig-name descname">Matrix</code><span class="sig-paren">(</span><em class="sig-param">dom</em>, <em class="sig-param">cod</em>, <em class="sig-param">array</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Box" title="discopy.pregroup.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Box</span></code></a></p>
<p>Implements a matrix with dom, cod and numpy array.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(1), array=[0])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.matrix.Matrix.array">
<em class="property">property </em><code class="sig-name descname">array</code><a class="headerlink" href="#discopy.matrix.Matrix.array" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">[0, 1, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.matrix.Matrix.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Matrix</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.matrix.Matrix.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Matrix</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2), cod=Dim(2, 2), array=[1, 0, 0, 1, 0, 1, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.matrix.Matrix.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.matrix.Matrix.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.matrix.Matrix.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the normalisation of rigid monoidal categories,
see arxiv:1601.05372, definition 2.12.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">counit</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;counit&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twist</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">twist</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">twist</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">twist</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">twist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">counit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">unit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_rl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_rl</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_lr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_lr</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eckmann_Hilton</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Eckmann_Hilton</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">Diagram s0 &gt;&gt; s1 is not connected.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.matrix.Matrix.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">@</span> <span class="n">v</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">@</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2), cod=Dim(2), array=[1, 0, 0, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">v</span> <span class="o">@</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Dim</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">==</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.Matrix.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.Matrix.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.matrix.MatrixFunctor">
<em class="property">class </em><code class="sig-prename descclassname">discopy.matrix.</code><code class="sig-name descname">MatrixFunctor</code><span class="sig-paren">(</span><em class="sig-param">ob</em>, <em class="sig-param">ar</em>, <em class="sig-param">ob_cls=&lt;class 'discopy.matrix.Dim'&gt;</em>, <em class="sig-param">ar_cls=&lt;class 'discopy.matrix.Matrix'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.matrix.MatrixFunctor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.PivotalFunctor" title="discopy.pregroup.PivotalFunctor"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.PivotalFunctor</span></code></a></p>
<p>Implements a matrix-valued pivotal functor.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">MatrixFunctor</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="n">f</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2), array=[0, 1])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.matrix.MatrixFunctor.ar">
<em class="property">property </em><code class="sig-name descname">ar</code><a class="headerlink" href="#discopy.matrix.MatrixFunctor.ar" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ar</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.matrix.MatrixFunctor.ob">
<em class="property">property </em><code class="sig-name descname">ob</code><a class="headerlink" href="#discopy.matrix.MatrixFunctor.ob" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ob</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-discopy.circuit"></span><p>Implements quantum circuits as diagrams and circuit-valued monoidal functors.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bob</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="n">Alice</span><span class="p">:</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">loves</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="n">Bob</span><span class="p">:</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">CircuitFunctor</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="p">(</span><span class="n">Alice</span> <span class="o">&gt;&gt;</span> <span class="n">loves</span> <span class="o">&gt;&gt;</span> <span class="n">Bob</span><span class="p">)</span>
<span class="go">Circuit(0, 0, [Ket(0), Gate(&#39;X&#39;, 1, [0, 1, 1, 0]), Bra(1)], [0, 0, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">Alice</span> <span class="o">&gt;&gt;</span> <span class="n">loves</span> <span class="o">&gt;&gt;</span> <span class="n">Bob</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
<dl class="class">
<dt id="discopy.circuit.Bra">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">Bra</code><span class="sig-paren">(</span><em class="sig-param">*bitstring</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Box" title="discopy.pregroup.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Box</span></code></a>, <a class="reference internal" href="#discopy.circuit.Circuit" title="discopy.circuit.Circuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.circuit.Circuit</span></code></a></p>
<p>Implements bra for a given bitstring.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Bra</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2, 2), cod=Dim(1), array=[0, 0, 0, 0, 0, 0, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">((</span><span class="n">Bra</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">Ket</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">... </span>           <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.Bra.array">
<em class="property">property </em><code class="sig-name descname">array</code><a class="headerlink" href="#discopy.circuit.Bra.array" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2), cod=Dim(1), array=[1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2), cod=Dim(1), array=[0, 1, 0, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.circuit.Bra.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1, 0, 0, 0]</span>
<span class="go">[0, 1, 0, 0]</span>
<span class="go">[0, 0, 1, 0]</span>
<span class="go">[0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.circuit.Bra.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2), cod=Dim(1), array=[1.0, 0.0, 0.0, 1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1.0, 0.0, 0.0, 0.0]</span>
<span class="go">[0.0, 1.0, 0.0, 0.0]</span>
<span class="go">[0.0, 0.0, 1.0, 0.0]</span>
<span class="go">[0.0, 0.0, 0.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Ket(0, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.circuit.Bra.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.circuit.Bra.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the circuit as a discopy Matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">S</span><span class="p">,</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">m</span><span class="p">,</span> <span class="n">id_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">(),</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">id_n</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.from_tk">
<em class="property">static </em><code class="sig-name descname">from_tk</code><span class="sig-paren">(</span><em class="sig-param">tk_circuit</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.from_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a pytket circuit and returns a planar circuit,
SWAP gates are introduced when applying gates to non-adjacent qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">from_tk</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">to_tk</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">c2</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.gates">
<em class="property">property </em><code class="sig-name descname">gates</code><a class="headerlink" href="#discopy.circuit.Bra.gates" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gates</span>
<span class="go">[Gate(&#39;X&#39;, 1, [0, 1, 1, 0]), Gate(&#39;X&#39;, 1, [0, 1, 1, 0])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Id(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.measure">
<code class="sig-name descname">measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Born rule and outputs a stochastic matrix.
The input maybe any circuit c, the output will be a numpy array
with shape len(c.dom &#64; c.cod) * (2, )</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[0.0, 1.0, 1.0, 0.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.circuit.Bra.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span> <span class="o">&gt;&gt;</span> <span class="n">X</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">())</span>
<span class="go">X @ Id(1) &gt;&gt; Id(1) @ X</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(1) @ X &gt;&gt; X @ Id(1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.circuit.Bra.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.random">
<em class="property">static </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param">n_qubits</em>, <em class="sig-param">depth=3</em>, <em class="sig-param">gateset=None</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random Euler decomposition if n_qubits == 1,
otherwise returns a random tiling with the given depth and gateset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  
<span class="go">Rx(0.026...) &gt;&gt; Rz(0.781...) &gt;&gt; Rx(0.272...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX &gt;&gt; T @ Id(1) &gt;&gt; Id(1) @ T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ T &gt;&gt; H @ Id(2) &gt;&gt; Id(1) @ H @ Id(1) &gt;&gt; Id(2) @ H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">Rz</span><span class="p">,</span> <span class="n">Rx</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">Rz(0.6731171219152886) @ Id(1) &gt;&gt; Id(1) @ Rx(0.2726063832840899)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ H</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SWAP</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span>
<span class="go">SWAP &gt;&gt; CX</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.to_tk">
<code class="sig-name descname">to_tk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.to_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pytket circuit.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_tk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[SWAP q[0], q[1];, Rx(0.25PI) q[1];, CX q[1], q[2];]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Bra.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Bra.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.circuit.Circuit">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">Circuit</code><span class="sig-paren">(</span><em class="sig-param">dom</em>, <em class="sig-param">cod</em>, <em class="sig-param">gates</em>, <em class="sig-param">offsets</em>, <em class="sig-param">_fast=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Diagram" title="discopy.pregroup.Diagram"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Diagram</span></code></a></p>
<p>Implements quantum circuits as diagrams.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.Circuit.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.circuit.Circuit.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1, 0, 0, 0]</span>
<span class="go">[0, 1, 0, 0]</span>
<span class="go">[0, 0, 1, 0]</span>
<span class="go">[0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.circuit.Circuit.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2), cod=Dim(1), array=[1.0, 0.0, 0.0, 1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1.0, 0.0, 0.0, 0.0]</span>
<span class="go">[0.0, 1.0, 0.0, 0.0]</span>
<span class="go">[0.0, 0.0, 1.0, 0.0]</span>
<span class="go">[0.0, 0.0, 0.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span>
<span class="go">SWAP.dagger() &gt;&gt; CX.dagger()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.circuit.Circuit.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the circuit as a discopy Matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">S</span><span class="p">,</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">m</span><span class="p">,</span> <span class="n">id_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">(),</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">id_n</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.from_tk">
<em class="property">static </em><code class="sig-name descname">from_tk</code><span class="sig-paren">(</span><em class="sig-param">tk_circuit</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.from_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a pytket circuit and returns a planar circuit,
SWAP gates are introduced when applying gates to non-adjacent qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">from_tk</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">to_tk</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">c2</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.gates">
<em class="property">property </em><code class="sig-name descname">gates</code><a class="headerlink" href="#discopy.circuit.Circuit.gates" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gates</span>
<span class="go">[Gate(&#39;X&#39;, 1, [0, 1, 1, 0]), Gate(&#39;X&#39;, 1, [0, 1, 1, 0])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Id(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.measure">
<code class="sig-name descname">measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Born rule and outputs a stochastic matrix.
The input maybe any circuit c, the output will be a numpy array
with shape len(c.dom &#64; c.cod) * (2, )</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[0.0, 1.0, 1.0, 0.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span> <span class="o">&gt;&gt;</span> <span class="n">X</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">())</span>
<span class="go">X @ Id(1) &gt;&gt; Id(1) @ X</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(1) @ X &gt;&gt; X @ Id(1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.circuit.Circuit.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.random">
<em class="property">static </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param">n_qubits</em>, <em class="sig-param">depth=3</em>, <em class="sig-param">gateset=None</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random Euler decomposition if n_qubits == 1,
otherwise returns a random tiling with the given depth and gateset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  
<span class="go">Rx(0.026...) &gt;&gt; Rz(0.781...) &gt;&gt; Rx(0.272...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX &gt;&gt; T @ Id(1) &gt;&gt; Id(1) @ T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ T &gt;&gt; H @ Id(2) &gt;&gt; Id(1) @ H @ Id(1) &gt;&gt; Id(2) @ H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">Rz</span><span class="p">,</span> <span class="n">Rx</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">Rz(0.6731171219152886) @ Id(1) &gt;&gt; Id(1) @ Rx(0.2726063832840899)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ H</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SWAP</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span>
<span class="go">SWAP &gt;&gt; CX</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.to_tk">
<code class="sig-name descname">to_tk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.to_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pytket circuit.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_tk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[SWAP q[0], q[1];, Rx(0.25PI) q[1];, CX q[1], q[2];]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Circuit.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Circuit.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.circuit.CircuitFunctor">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">CircuitFunctor</code><span class="sig-paren">(</span><em class="sig-param">ob</em>, <em class="sig-param">ar</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.CircuitFunctor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.PivotalFunctor" title="discopy.pregroup.PivotalFunctor"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.PivotalFunctor</span></code></a></p>
<p>Implements funtors from monoidal categories to circuits</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gp">... </span>      <span class="o">&gt;&gt;</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">g</span> <span class="o">@</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gp">... </span>      <span class="o">&gt;&gt;</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">h</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="p">:</span> <span class="n">SWAP</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">h</span><span class="p">:</span> <span class="n">CX</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">CircuitFunctor</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="go">SWAP @ Id(1) &gt;&gt; Id(1) @ Rx(0.25) @ Id(1) &gt;&gt; Id(1) @ CX</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.CircuitFunctor.ar">
<em class="property">property </em><code class="sig-name descname">ar</code><a class="headerlink" href="#discopy.circuit.CircuitFunctor.ar" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ar</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.CircuitFunctor.ob">
<em class="property">property </em><code class="sig-name descname">ob</code><a class="headerlink" href="#discopy.circuit.CircuitFunctor.ob" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ob</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.circuit.Gate">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">Gate</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">n_qubits</em>, <em class="sig-param">array=None</em>, <em class="sig-param">data=None</em>, <em class="sig-param">_dagger=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Box" title="discopy.pregroup.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Box</span></code></a>, <a class="reference internal" href="#discopy.circuit.Circuit" title="discopy.circuit.Circuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.circuit.Circuit</span></code></a></p>
<p>Implements quantum gates as boxes in a circuit diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CX</span>
<span class="go">Gate(&#39;CX&#39;, 2, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.Gate.array">
<em class="property">property </em><code class="sig-name descname">array</code><a class="headerlink" href="#discopy.circuit.Gate.array" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">[0, 1, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.circuit.Gate.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1, 0, 0, 0]</span>
<span class="go">[0, 1, 0, 0]</span>
<span class="go">[0, 0, 1, 0]</span>
<span class="go">[0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.circuit.Gate.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2), cod=Dim(1), array=[1.0, 0.0, 0.0, 1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1.0, 0.0, 0.0, 0.0]</span>
<span class="go">[0.0, 1.0, 0.0, 0.0]</span>
<span class="go">[0.0, 0.0, 1.0, 0.0]</span>
<span class="go">[0.0, 0.0, 0.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span>
<span class="go">CX.dagger()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span>
<span class="go">Rx(-0.25)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">==</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.circuit.Gate.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.circuit.Gate.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the circuit as a discopy Matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">S</span><span class="p">,</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">m</span><span class="p">,</span> <span class="n">id_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">(),</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">id_n</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.from_tk">
<em class="property">static </em><code class="sig-name descname">from_tk</code><span class="sig-paren">(</span><em class="sig-param">tk_circuit</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.from_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a pytket circuit and returns a planar circuit,
SWAP gates are introduced when applying gates to non-adjacent qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">from_tk</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">to_tk</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">c2</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.gates">
<em class="property">property </em><code class="sig-name descname">gates</code><a class="headerlink" href="#discopy.circuit.Gate.gates" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gates</span>
<span class="go">[Gate(&#39;X&#39;, 1, [0, 1, 1, 0]), Gate(&#39;X&#39;, 1, [0, 1, 1, 0])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Id(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.measure">
<code class="sig-name descname">measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Born rule and outputs a stochastic matrix.
The input maybe any circuit c, the output will be a numpy array
with shape len(c.dom &#64; c.cod) * (2, )</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[0.0, 1.0, 1.0, 0.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.circuit.Gate.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span> <span class="o">&gt;&gt;</span> <span class="n">X</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">())</span>
<span class="go">X @ Id(1) &gt;&gt; Id(1) @ X</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(1) @ X &gt;&gt; X @ Id(1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.circuit.Gate.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.random">
<em class="property">static </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param">n_qubits</em>, <em class="sig-param">depth=3</em>, <em class="sig-param">gateset=None</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random Euler decomposition if n_qubits == 1,
otherwise returns a random tiling with the given depth and gateset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  
<span class="go">Rx(0.026...) &gt;&gt; Rz(0.781...) &gt;&gt; Rx(0.272...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX &gt;&gt; T @ Id(1) &gt;&gt; Id(1) @ T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ T &gt;&gt; H @ Id(2) &gt;&gt; Id(1) @ H @ Id(1) &gt;&gt; Id(2) @ H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">Rz</span><span class="p">,</span> <span class="n">Rx</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">Rz(0.6731171219152886) @ Id(1) &gt;&gt; Id(1) @ Rx(0.2726063832840899)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ H</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SWAP</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span>
<span class="go">SWAP &gt;&gt; CX</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.to_tk">
<code class="sig-name descname">to_tk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.to_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pytket circuit.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_tk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[SWAP q[0], q[1];, Rx(0.25PI) q[1];, CX q[1], q[2];]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Gate.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Gate.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.circuit.Id">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">Id</code><span class="sig-paren">(</span><em class="sig-param">n_qubits</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.circuit.Circuit" title="discopy.circuit.Circuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.circuit.Circuit</span></code></a></p>
<p>Implements identity circuit on n qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">CX</span> <span class="o">@</span> <span class="n">H</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">@</span> <span class="n">SWAP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">==</span> <span class="n">c</span> <span class="o">==</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.Id.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.circuit.Id.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1, 0, 0, 0]</span>
<span class="go">[0, 1, 0, 0]</span>
<span class="go">[0, 0, 1, 0]</span>
<span class="go">[0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.circuit.Id.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2), cod=Dim(1), array=[1.0, 0.0, 0.0, 1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1.0, 0.0, 0.0, 0.0]</span>
<span class="go">[0.0, 1.0, 0.0, 0.0]</span>
<span class="go">[0.0, 0.0, 1.0, 0.0]</span>
<span class="go">[0.0, 0.0, 0.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span>
<span class="go">SWAP.dagger() &gt;&gt; CX.dagger()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.circuit.Id.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the circuit as a discopy Matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">S</span><span class="p">,</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">m</span><span class="p">,</span> <span class="n">id_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">(),</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">id_n</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.from_tk">
<em class="property">static </em><code class="sig-name descname">from_tk</code><span class="sig-paren">(</span><em class="sig-param">tk_circuit</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.from_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a pytket circuit and returns a planar circuit,
SWAP gates are introduced when applying gates to non-adjacent qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">from_tk</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">to_tk</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">c2</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.gates">
<em class="property">property </em><code class="sig-name descname">gates</code><a class="headerlink" href="#discopy.circuit.Id.gates" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gates</span>
<span class="go">[Gate(&#39;X&#39;, 1, [0, 1, 1, 0]), Gate(&#39;X&#39;, 1, [0, 1, 1, 0])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Id(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.measure">
<code class="sig-name descname">measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Born rule and outputs a stochastic matrix.
The input maybe any circuit c, the output will be a numpy array
with shape len(c.dom &#64; c.cod) * (2, )</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[0.0, 1.0, 1.0, 0.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span> <span class="o">&gt;&gt;</span> <span class="n">X</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">())</span>
<span class="go">X @ Id(1) &gt;&gt; Id(1) @ X</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(1) @ X &gt;&gt; X @ Id(1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.circuit.Id.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.random">
<em class="property">static </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param">n_qubits</em>, <em class="sig-param">depth=3</em>, <em class="sig-param">gateset=None</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random Euler decomposition if n_qubits == 1,
otherwise returns a random tiling with the given depth and gateset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  
<span class="go">Rx(0.026...) &gt;&gt; Rz(0.781...) &gt;&gt; Rx(0.272...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX &gt;&gt; T @ Id(1) &gt;&gt; Id(1) @ T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ T &gt;&gt; H @ Id(2) &gt;&gt; Id(1) @ H @ Id(1) &gt;&gt; Id(2) @ H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">Rz</span><span class="p">,</span> <span class="n">Rx</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">Rz(0.6731171219152886) @ Id(1) &gt;&gt; Id(1) @ Rx(0.2726063832840899)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ H</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SWAP</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span>
<span class="go">SWAP &gt;&gt; CX</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.to_tk">
<code class="sig-name descname">to_tk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.to_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pytket circuit.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_tk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[SWAP q[0], q[1];, Rx(0.25PI) q[1];, CX q[1], q[2];]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Id.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Id.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.circuit.Ket">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">Ket</code><span class="sig-paren">(</span><em class="sig-param">*bitstring</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Box" title="discopy.pregroup.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Box</span></code></a>, <a class="reference internal" href="#discopy.circuit.Circuit" title="discopy.circuit.Circuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.circuit.Circuit</span></code></a></p>
<p>Implements ket for a given bitstring.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2, 2), array=[0, 0, 0, 0, 0, 0, 1, 0])</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.Ket.array">
<em class="property">property </em><code class="sig-name descname">array</code><a class="headerlink" href="#discopy.circuit.Ket.array" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2), array=[1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[0, 1, 0, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.circuit.Ket.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1, 0, 0, 0]</span>
<span class="go">[0, 1, 0, 0]</span>
<span class="go">[0, 0, 1, 0]</span>
<span class="go">[0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.circuit.Ket.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2), cod=Dim(1), array=[1.0, 0.0, 0.0, 1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1.0, 0.0, 0.0, 0.0]</span>
<span class="go">[0.0, 1.0, 0.0, 0.0]</span>
<span class="go">[0.0, 0.0, 1.0, 0.0]</span>
<span class="go">[0.0, 0.0, 0.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Bra(0, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.circuit.Ket.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.circuit.Ket.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the circuit as a discopy Matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">S</span><span class="p">,</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">m</span><span class="p">,</span> <span class="n">id_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">(),</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">id_n</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.from_tk">
<em class="property">static </em><code class="sig-name descname">from_tk</code><span class="sig-paren">(</span><em class="sig-param">tk_circuit</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.from_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a pytket circuit and returns a planar circuit,
SWAP gates are introduced when applying gates to non-adjacent qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">from_tk</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">to_tk</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">c2</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.gates">
<em class="property">property </em><code class="sig-name descname">gates</code><a class="headerlink" href="#discopy.circuit.Ket.gates" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gates</span>
<span class="go">[Gate(&#39;X&#39;, 1, [0, 1, 1, 0]), Gate(&#39;X&#39;, 1, [0, 1, 1, 0])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Id(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.measure">
<code class="sig-name descname">measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Born rule and outputs a stochastic matrix.
The input maybe any circuit c, the output will be a numpy array
with shape len(c.dom &#64; c.cod) * (2, )</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[0.0, 1.0, 1.0, 0.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.circuit.Ket.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span> <span class="o">&gt;&gt;</span> <span class="n">X</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">())</span>
<span class="go">X @ Id(1) &gt;&gt; Id(1) @ X</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(1) @ X &gt;&gt; X @ Id(1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.circuit.Ket.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.random">
<em class="property">static </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param">n_qubits</em>, <em class="sig-param">depth=3</em>, <em class="sig-param">gateset=None</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random Euler decomposition if n_qubits == 1,
otherwise returns a random tiling with the given depth and gateset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  
<span class="go">Rx(0.026...) &gt;&gt; Rz(0.781...) &gt;&gt; Rx(0.272...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX &gt;&gt; T @ Id(1) &gt;&gt; Id(1) @ T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ T &gt;&gt; H @ Id(2) &gt;&gt; Id(1) @ H @ Id(1) &gt;&gt; Id(2) @ H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">Rz</span><span class="p">,</span> <span class="n">Rx</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">Rz(0.6731171219152886) @ Id(1) &gt;&gt; Id(1) @ Rx(0.2726063832840899)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ H</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SWAP</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span>
<span class="go">SWAP &gt;&gt; CX</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.to_tk">
<code class="sig-name descname">to_tk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.to_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pytket circuit.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_tk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[SWAP q[0], q[1];, Rx(0.25PI) q[1];, CX q[1], q[2];]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Ket.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Ket.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.circuit.PRO">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">PRO</code><span class="sig-paren">(</span><em class="sig-param">n=0</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.PRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Ty" title="discopy.pregroup.Ty"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Ty</span></code></a></p>
<p>Implements the objects of a PRO, i.e. a non-symmetric PROP.
Wraps a natural number n into a unary type Ty(1, …, 1) of length n.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">PRO(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">Ty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.PRO.is_basic">
<em class="property">property </em><code class="sig-name descname">is_basic</code><a class="headerlink" href="#discopy.circuit.PRO.is_basic" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">s</span><span class="o">.</span><span class="n">is_basic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">is_basic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">is_basic</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.PRO.l">
<em class="property">property </em><code class="sig-name descname">l</code><a class="headerlink" href="#discopy.circuit.PRO.l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">l</span> <span class="o">==</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.PRO.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.circuit.PRO.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the object, can be of any type.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;x&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.PRO.objects">
<em class="property">property </em><code class="sig-name descname">objects</code><a class="headerlink" href="#discopy.circuit.PRO.objects" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">objects</span>
<span class="go">[Ob(&#39;x&#39;), Ob(&#39;y&#39;), Ob(&#39;z&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.PRO.r">
<em class="property">property </em><code class="sig-name descname">r</code><a class="headerlink" href="#discopy.circuit.PRO.r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">r</span> <span class="o">==</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.circuit.Rx">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">Rx</code><span class="sig-paren">(</span><em class="sig-param">phase</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.circuit.Gate" title="discopy.circuit.Gate"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.circuit.Gate</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.Rx.array">
<em class="property">property </em><code class="sig-name descname">array</code><a class="headerlink" href="#discopy.circuit.Rx.array" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">),</span> <span class="n">X</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.circuit.Rx.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1, 0, 0, 0]</span>
<span class="go">[0, 1, 0, 0]</span>
<span class="go">[0, 0, 1, 0]</span>
<span class="go">[0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.circuit.Rx.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2), cod=Dim(1), array=[1.0, 0.0, 0.0, 1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1.0, 0.0, 0.0, 0.0]</span>
<span class="go">[0.0, 1.0, 0.0, 0.0]</span>
<span class="go">[0.0, 0.0, 1.0, 0.0]</span>
<span class="go">[0.0, 0.0, 0.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.circuit.Rx.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.circuit.Rx.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the circuit as a discopy Matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">S</span><span class="p">,</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">m</span><span class="p">,</span> <span class="n">id_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">(),</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">id_n</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.from_tk">
<em class="property">static </em><code class="sig-name descname">from_tk</code><span class="sig-paren">(</span><em class="sig-param">tk_circuit</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.from_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a pytket circuit and returns a planar circuit,
SWAP gates are introduced when applying gates to non-adjacent qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">from_tk</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">to_tk</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">c2</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.gates">
<em class="property">property </em><code class="sig-name descname">gates</code><a class="headerlink" href="#discopy.circuit.Rx.gates" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gates</span>
<span class="go">[Gate(&#39;X&#39;, 1, [0, 1, 1, 0]), Gate(&#39;X&#39;, 1, [0, 1, 1, 0])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Id(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.measure">
<code class="sig-name descname">measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Born rule and outputs a stochastic matrix.
The input maybe any circuit c, the output will be a numpy array
with shape len(c.dom &#64; c.cod) * (2, )</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[0.0, 1.0, 1.0, 0.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.circuit.Rx.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">Rx</span><span class="p">(</span><span class="mf">0.125</span><span class="p">))</span> <span class="o">==</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span> <span class="o">&gt;&gt;</span> <span class="n">X</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">())</span>
<span class="go">X @ Id(1) &gt;&gt; Id(1) @ X</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(1) @ X &gt;&gt; X @ Id(1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.circuit.Rx.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.phase">
<em class="property">property </em><code class="sig-name descname">phase</code><a class="headerlink" href="#discopy.circuit.Rx.phase" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span><span class="o">.</span><span class="n">phase</span>
<span class="go">0.25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.random">
<em class="property">static </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param">n_qubits</em>, <em class="sig-param">depth=3</em>, <em class="sig-param">gateset=None</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random Euler decomposition if n_qubits == 1,
otherwise returns a random tiling with the given depth and gateset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  
<span class="go">Rx(0.026...) &gt;&gt; Rz(0.781...) &gt;&gt; Rx(0.272...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX &gt;&gt; T @ Id(1) &gt;&gt; Id(1) @ T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ T &gt;&gt; H @ Id(2) &gt;&gt; Id(1) @ H @ Id(1) &gt;&gt; Id(2) @ H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">Rz</span><span class="p">,</span> <span class="n">Rx</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">Rz(0.6731171219152886) @ Id(1) &gt;&gt; Id(1) @ Rx(0.2726063832840899)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ H</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SWAP</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span>
<span class="go">SWAP &gt;&gt; CX</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.to_tk">
<code class="sig-name descname">to_tk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.to_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pytket circuit.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_tk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[SWAP q[0], q[1];, Rx(0.25PI) q[1];, CX q[1], q[2];]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rx.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rx.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.circuit.Rz">
<em class="property">class </em><code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">Rz</code><span class="sig-paren">(</span><em class="sig-param">phase</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.circuit.Gate" title="discopy.circuit.Gate"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.circuit.Gate</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.circuit.Rz.array">
<em class="property">property </em><code class="sig-name descname">array</code><a class="headerlink" href="#discopy.circuit.Rz.array" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.circuit.Rz.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.caps" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(1), cod=Dim(2, 2), array=[1, 0, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1, 0, 0, 0]</span>
<span class="go">[0, 1, 0, 0]</span>
<span class="go">[0, 0, 1, 0]</span>
<span class="go">[0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.circuit.Rz.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.cups" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">Matrix(dom=Dim(2, 2), cod=Dim(1), array=[1.0, 0.0, 0.0, 1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">PRO</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[1.0, 0.0, 0.0, 0.0]</span>
<span class="go">[0.0, 1.0, 0.0, 0.0]</span>
<span class="go">[0.0, 0.0, 1.0, 0.0]</span>
<span class="go">[0.0, 0.0, 0.0, 1.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Rz</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Rz</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.circuit.Rz.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.circuit.Rz.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the circuit as a discopy Matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SWAP</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">S</span><span class="p">,</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">m</span><span class="p">,</span> <span class="n">id_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">(),</span> <span class="n">Id</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">dom</span><span class="p">))</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">id_n</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.from_tk">
<em class="property">static </em><code class="sig-name descname">from_tk</code><span class="sig-paren">(</span><em class="sig-param">tk_circuit</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.from_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a pytket circuit and returns a planar circuit,
SWAP gates are introduced when applying gates to non-adjacent qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">from_tk</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">to_tk</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c1</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">c2</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.gates">
<em class="property">property </em><code class="sig-name descname">gates</code><a class="headerlink" href="#discopy.circuit.Rz.gates" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gates</span>
<span class="go">[Gate(&#39;X&#39;, 1, [0, 1, 1, 0]), Gate(&#39;X&#39;, 1, [0, 1, 1, 0])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Circuit</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Id(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.measure">
<code class="sig-name descname">measure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the Born rule and outputs a stochastic matrix.
The input maybe any circuit c, the output will be a numpy array
with shape len(c.dom &#64; c.cod) * (2, )</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="go">[0.0, 1.0, 1.0, 0.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">Bra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.circuit.Rz.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="mf">0.125</span><span class="p">))</span> <span class="o">==</span> <span class="nb">repr</span><span class="p">(</span><span class="n">Rz</span><span class="p">(</span><span class="mf">0.125</span><span class="p">))</span> <span class="o">==</span> <span class="n">Rz</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">circuit</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span> <span class="o">&gt;&gt;</span> <span class="n">X</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">())</span>
<span class="go">X @ Id(1) &gt;&gt; Id(1) @ X</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(1) @ X &gt;&gt; X @ Id(1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.circuit.Rz.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.phase">
<em class="property">property </em><code class="sig-name descname">phase</code><a class="headerlink" href="#discopy.circuit.Rz.phase" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Rz</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span><span class="o">.</span><span class="n">phase</span>
<span class="go">0.25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.random">
<em class="property">static </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param">n_qubits</em>, <em class="sig-param">depth=3</em>, <em class="sig-param">gateset=None</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random Euler decomposition if n_qubits == 1,
otherwise returns a random tiling with the given depth and gateset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  
<span class="go">Rx(0.026...) &gt;&gt; Rz(0.781...) &gt;&gt; Rx(0.272...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX &gt;&gt; T @ Id(1) &gt;&gt; Id(1) @ T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">CX</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ T &gt;&gt; H @ Id(2) &gt;&gt; Id(1) @ H @ Id(1) &gt;&gt; Id(2) @ H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Circuit</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gateset</span><span class="o">=</span><span class="p">[</span><span class="n">Rz</span><span class="p">,</span> <span class="n">Rx</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">420</span><span class="p">))</span>
<span class="go">Rz(0.6731171219152886) @ Id(1) &gt;&gt; Id(1) @ Rx(0.2726063832840899)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CX</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
<span class="go">CX @ Id(1) &gt;&gt; Id(2) @ H</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SWAP</span> <span class="o">&gt;&gt;</span> <span class="n">CX</span><span class="p">)</span>
<span class="go">SWAP &gt;&gt; CX</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.to_tk">
<code class="sig-name descname">to_tk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.to_tk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pytket circuit.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">Rx</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">CX</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_tk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">[SWAP q[0], q[1];, Rx(0.25PI) q[1];, CX q[1], q[2];]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.circuit.Rz.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.Rz.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="discopy.circuit.sqrt">
<code class="sig-prename descclassname">discopy.circuit.</code><code class="sig-name descname">sqrt</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.circuit.sqrt" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  
<span class="go">Gate(&#39;sqrt(2)&#39;, 0, [1.41...])</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-discopy.disco"></span><p>Implements disco models in the category of matrices and circuits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span><span class="p">,</span> <span class="n">Bob</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sentence</span> <span class="o">=</span> <span class="n">grammar</span> <span class="o">&lt;&lt;</span> <span class="n">Alice</span> <span class="o">@</span> <span class="n">loves</span> <span class="o">@</span> <span class="n">Bob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="p">{</span><span class="n">Alice</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">loves</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Bob</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span>
</pre></div>
</div>
<dl class="class">
<dt id="discopy.disco.CircuitModel">
<em class="property">class </em><code class="sig-prename descclassname">discopy.disco.</code><code class="sig-name descname">CircuitModel</code><span class="sig-paren">(</span><em class="sig-param">ob</em>, <em class="sig-param">ar</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.CircuitModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.circuit.CircuitFunctor" title="discopy.circuit.CircuitFunctor"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.circuit.CircuitFunctor</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">discopy.circuit</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Ket</span><span class="p">,</span> <span class="n">CX</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bob</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sentence</span> <span class="o">=</span> <span class="n">grammar</span> <span class="o">&lt;&lt;</span> <span class="n">Alice</span> <span class="o">@</span> <span class="n">loves</span> <span class="o">@</span> <span class="n">Bob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="p">{</span><span class="n">Alice</span><span class="p">:</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>      <span class="n">loves</span><span class="p">:</span> <span class="n">CX</span> <span class="o">&lt;&lt;</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">H</span> <span class="o">@</span> <span class="n">X</span> <span class="o">&lt;&lt;</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>      <span class="n">Bob</span><span class="p">:</span> <span class="n">Ket</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">CircuitModel</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">ar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BornRule</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">BornRule</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.disco.CircuitModel.ar">
<em class="property">property </em><code class="sig-name descname">ar</code><a class="headerlink" href="#discopy.disco.CircuitModel.ar" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ar</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.CircuitModel.ob">
<em class="property">property </em><code class="sig-name descname">ob</code><a class="headerlink" href="#discopy.disco.CircuitModel.ob" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ob</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="discopy.disco.FAIL">
<em class="property">exception </em><code class="sig-prename descclassname">discopy.disco.</code><code class="sig-name descname">FAIL</code><a class="headerlink" href="#discopy.disco.FAIL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; s, n = Ty(&#39;s&#39;), Ty(&#39;n&#39;)
&gt;&gt;&gt; Alice = Word(&#39;Alice&#39;, n)
&gt;&gt;&gt; loves = Word(&#39;loves&#39;, n.r @ s @ n.l)
&gt;&gt;&gt; Bob = Word(&#39;Bob&#39;, n)
&gt;&gt;&gt; eager_parse(Alice, Bob, loves)  
Traceback (most recent call last):
...
disco.FAIL
&gt;&gt;&gt; who = Word(&#39;who&#39;, n.r @ n @ s.l @ n)
&gt;&gt;&gt; eager_parse(Alice, loves, Bob, who, loves, Alice)  
Traceback (most recent call last):
...
disco.FAIL
</pre></div>
</div>
<dl class="attribute">
<dt id="discopy.disco.FAIL.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#discopy.disco.FAIL.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="discopy.disco.FAIL.with_traceback">
<code class="sig-name descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.FAIL.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.disco.Model">
<em class="property">class </em><code class="sig-prename descclassname">discopy.disco.</code><code class="sig-name descname">Model</code><span class="sig-paren">(</span><em class="sig-param">ob</em>, <em class="sig-param">ar</em>, <em class="sig-param">ob_cls=&lt;class 'discopy.matrix.Dim'&gt;</em>, <em class="sig-param">ar_cls=&lt;class 'discopy.matrix.Matrix'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.matrix.MatrixFunctor" title="discopy.matrix.MatrixFunctor"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.matrix.MatrixFunctor</span></code></a></p>
<p>Implements functors from pregroup grammars to matrices.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span><span class="p">,</span> <span class="n">jokes</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;jokes&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Model</span><span class="p">({</span><span class="n">s</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="n">Alice</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">jokes</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">F</span><span class="p">(</span><span class="n">Alice</span> <span class="o">@</span> <span class="n">jokes</span> <span class="o">&gt;&gt;</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.disco.Model.ar">
<em class="property">property </em><code class="sig-name descname">ar</code><a class="headerlink" href="#discopy.disco.Model.ar" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ar</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Model.ob">
<em class="property">property </em><code class="sig-name descname">ob</code><a class="headerlink" href="#discopy.disco.Model.ob" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Functor</span><span class="p">({},</span> <span class="p">{})</span><span class="o">.</span><span class="n">ob</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="discopy.disco.Word">
<em class="property">class </em><code class="sig-prename descclassname">discopy.disco.</code><code class="sig-name descname">Word</code><span class="sig-paren">(</span><em class="sig-param">w</em>, <em class="sig-param">t</em>, <em class="sig-param">_dagger=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#discopy.pregroup.Box" title="discopy.pregroup.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">discopy.pregroup.Box</span></code></a></p>
<p>Implements words as boxes with a pregroup type as codomain.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span> <span class="o">@</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span>
<span class="go">Word(&#39;Alice&#39;, Ty(&#39;n&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span>
<span class="go">Word(&#39;loves&#39;, Ty(Ob(&#39;n&#39;, z=1), &#39;s&#39;, Ob(&#39;n&#39;, z=-1)))</span>
</pre></div>
</div>
<dl class="method">
<dt id="discopy.disco.Word.boxes">
<em class="property">property </em><code class="sig-name descname">boxes</code><a class="headerlink" href="#discopy.disco.Word.boxes" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">boxes</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.caps">
<em class="property">static </em><code class="sig-name descname">caps</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.caps" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.l @ b.l are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">caps</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cap</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.cod">
<em class="property">property </em><code class="sig-name descname">cod</code><a class="headerlink" href="#discopy.disco.Word.cod" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">cod</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.cups">
<em class="property">static </em><code class="sig-name descname">cups</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.cups" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs nested cups witnessing adjointness of x and y</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span> <span class="o">@</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">pregroup.AxiomError</span>: <span class="n">a @ b @ a and a.r @ b.r are not adjoints.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">cups</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">&lt;&lt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.dagger">
<code class="sig-name descname">dagger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.dagger" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="go">Word(&#39;Alice&#39;, Ty(&#39;n&#39;)).dagger()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#discopy.disco.Word.data" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
<span class="go">[42, {0: 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.depth">
<code class="sig-name descname">depth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the depth of a diagram by slicing it</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.dom">
<em class="property">property </em><code class="sig-name descname">dom</code><a class="headerlink" href="#discopy.disco.Word.dom" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">dom</span>
<span class="go">Ob(&#39;x&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.draw">
<code class="sig-name descname">draw</code><span class="sig-paren">(</span><em class="sig-param">_test=False</em>, <em class="sig-param">_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.draw" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="go">box_1 (f)</span>
<span class="go">input_0 (y.l)</span>
<span class="go">output_0 (x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>
<span class="go">box_1 (-0.5, 2)</span>
<span class="go">input_0 (-0.5, 4)</span>
<span class="go">output_0 (-0.5, 0)</span>
<span class="go">wire_0_0 (-1.0, 3)</span>
<span class="go">wire_0_1 (0.0, 3)</span>
<span class="go">wire_1_0 (-1.5, 2)</span>
<span class="go">wire_1_2 (0.5, 2)</span>
<span class="go">wire_2_0 (-1.0, 1)</span>
<span class="go">wire_2_1 (0.0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> -&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="go">box_1 -&gt; wire_2_0</span>
<span class="go">input_0 -&gt; wire_0_0</span>
<span class="go">wire_0_0 -&gt; wire_1_0</span>
<span class="go">wire_0_1 -&gt; box_1</span>
<span class="go">wire_0_1 -&gt; wire_1_2</span>
<span class="go">wire_1_0 -&gt; wire_2_0</span>
<span class="go">wire_1_2 -&gt; wire_2_1</span>
<span class="go">wire_2_1 -&gt; output_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.flatten">
<code class="sig-name descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a diagram of diagrams and returns a diagram.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span> <span class="o">&gt;&gt;</span>\
<span class="gp">... </span>     <span class="n">g</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">f1</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.id">
<em class="property">static </em><code class="sig-name descname">id</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.id" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Diagram</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)))</span>
<span class="go">Id(s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.interchange">
<code class="sig-name descname">interchange</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">j</em>, <em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.interchange" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">())</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">Cap(x, x.r) @ Id(x @ x.l) &gt;&gt; Id(x @ x.r) @ Cup(x, x.l)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">interchange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">Id(x @ x.l) @ Cap(x, x.r) &gt;&gt; Cup(x, x.l) @ Id(x @ x.r)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#discopy.disco.Word.name" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ob</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}])</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.normal_form">
<code class="sig-name descname">normal_form</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the normalisation of rigid monoidal categories,
see arxiv:1601.05372, definition 2.12.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit</span><span class="p">,</span> <span class="n">counit</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">x</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;counit&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twist</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">twist</span><span class="o">.</span><span class="n">dom</span> <span class="o">!=</span> <span class="n">twist</span><span class="o">.</span><span class="n">cod</span> <span class="ow">and</span> <span class="n">twist</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">twist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Cap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">)</span> <span class="o">@</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">normal_form</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="o">&gt;&gt;</span> <span class="n">counit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">counit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">unit</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_rl</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_rl</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_lr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">transpose_lr</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">more_complicated</span> <span class="o">=</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">more_complicated</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eckmann_Hilton</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span> <span class="o">@</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(),</span> <span class="n">Ty</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Eckmann_Hilton</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="go">Diagram s0 &gt;&gt; s1 is not connected.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">left=False</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator which yields normalization steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cup</span><span class="p">,</span> <span class="n">cap</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="n">Cap</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagram</span> <span class="o">=</span> <span class="n">g</span> <span class="o">@</span> <span class="n">cap</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">cup</span> <span class="o">@</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; ... &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; Id(n) @ Cap(n.r, n) &gt;&gt; Cup(n, n.r) @ Id(n) &gt;&gt; f &gt;&gt; h</span>
<span class="go">g &gt;&gt; f.dagger() &gt;&gt; f &gt;&gt; h</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.offsets">
<em class="property">property </em><code class="sig-name descname">offsets</code><a class="headerlink" href="#discopy.disco.Word.offsets" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Diagram</span><span class="p">(</span><span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[])</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagram with diagrams of depth 1 as boxes such that its
flattening gives the original diagram back, up to normal form.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">f0</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f1</span> <span class="o">&gt;&gt;</span> <span class="n">Id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">@</span> <span class="n">f0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">slice</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">normal_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.tensor">
<code class="sig-name descname">tensor</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.tensor" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">@</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f.dagger() @ Id(a) &gt;&gt; Id(a) @ f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.then">
<code class="sig-name descname">then</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.then" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">)</span>
<span class="go">f &gt;&gt; f.dagger() &gt;&gt; f</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.transpose_l">
<code class="sig-name descname">transpose_l</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.transpose_l" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_l</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.transpose_r">
<code class="sig-name descname">transpose_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.Word.transpose_r" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two_snakes</span> <span class="o">=</span> <span class="n">Id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">two_snakes_nf</span> <span class="o">=</span> <span class="n">moncat</span><span class="o">.</span><span class="n">Diagram</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">two_snakes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">double_snake</span> <span class="o">==</span> <span class="n">two_snakes_nf</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.type">
<em class="property">property </em><code class="sig-name descname">type</code><a class="headerlink" href="#discopy.disco.Word.type" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">type</span>
<span class="go">Ty(&#39;n&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="discopy.disco.Word.word">
<em class="property">property </em><code class="sig-name descname">word</code><a class="headerlink" href="#discopy.disco.Word.word" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">word</span>
<span class="go">&#39;Alice&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="discopy.disco.brute_force">
<code class="sig-prename descclassname">discopy.disco.</code><code class="sig-name descname">brute_force</code><span class="sig-paren">(</span><em class="sig-param">*vocab</em>, <em class="sig-param">target=Ty('s')</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.brute_force" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bob</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">brute_force</span><span class="p">(</span><span class="n">Alice</span><span class="p">,</span> <span class="n">loves</span><span class="p">,</span> <span class="n">Bob</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span> <span class="o">==</span> <span class="n">Alice</span> <span class="o">@</span> <span class="n">loves</span> <span class="o">@</span> <span class="n">Alice</span> <span class="o">&gt;&gt;</span> <span class="n">grammar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span> <span class="o">==</span> <span class="n">Alice</span> <span class="o">@</span> <span class="n">loves</span> <span class="o">@</span> <span class="n">Bob</span> <span class="o">&gt;&gt;</span> <span class="n">grammar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span> <span class="o">==</span> <span class="n">Bob</span> <span class="o">@</span> <span class="n">loves</span> <span class="o">@</span> <span class="n">Alice</span> <span class="o">&gt;&gt;</span> <span class="n">grammar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span> <span class="o">==</span> <span class="n">Bob</span> <span class="o">@</span> <span class="n">loves</span> <span class="o">@</span> <span class="n">Bob</span> <span class="o">&gt;&gt;</span> <span class="n">grammar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">brute_force</span><span class="p">(</span><span class="n">Alice</span><span class="p">,</span> <span class="n">loves</span><span class="p">,</span> <span class="n">Bob</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="go">Word(&#39;Alice&#39;, Ty(&#39;n&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="go">Word(&#39;Bob&#39;, Ty(&#39;n&#39;))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="discopy.disco.eager_parse">
<code class="sig-prename descclassname">discopy.disco.</code><code class="sig-name descname">eager_parse</code><span class="sig-paren">(</span><em class="sig-param">*words</em>, <em class="sig-param">target=Ty('s')</em><span class="sig-paren">)</span><a class="headerlink" href="#discopy.disco.eager_parse" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">Ty</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alice</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loves</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;loves&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">s</span> <span class="o">@</span> <span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bob</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grammar</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">Id</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">Cup</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">eager_parse</span><span class="p">(</span><span class="n">Alice</span><span class="p">,</span> <span class="n">loves</span><span class="p">,</span> <span class="n">Bob</span><span class="p">)</span> <span class="o">==</span> <span class="n">grammar</span> <span class="o">&lt;&lt;</span> <span class="n">Alice</span> <span class="o">@</span> <span class="n">loves</span> <span class="o">@</span> <span class="n">Bob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">who</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;who&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">r</span> <span class="o">@</span> <span class="n">n</span> <span class="o">@</span> <span class="n">s</span><span class="o">.</span><span class="n">l</span> <span class="o">@</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eager_parse</span><span class="p">(</span><span class="n">Bob</span><span class="p">,</span> <span class="n">who</span><span class="p">,</span> <span class="n">loves</span><span class="p">,</span> <span class="n">Alice</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">offsets</span>
<span class="go">[0, 1, 5, 8, 0, 2, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">discopy</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Quantum Group Oxford.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>